<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>WhaleWatch | Home</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #001d2d;
      color: white;
      margin: 0;
      padding: 0;
    }
    nav {
      background-color: #001520;
      padding: 1em;
      text-align: center;
      display: flex;
      justify-content: center;
      gap: 1em;
      flex-wrap: wrap;
    }
    nav a {
      color: #00ffee;
      font-weight: bold;
      text-decoration: none;
    }
    .hero {
      text-align: center;
      padding: 4em 2em 2em;
      background-color: #002b3f;
    }
    .homepage-logo {
      width: 100px;
      margin-bottom: 1rem;
      filter: drop-shadow(0 0 10px #00ffee);
    }
    .hero h1 {
      font-size: 2.8em;
      color: #00ffee;
    }
    .hero p {
      font-size: 1.2em;
      color: #ccc;
      margin: 0.8em 0 1.5em;
    }
    .cta-button {
      background-color: #00ffee;
      color: #001520;
      font-weight: bold;
      padding: 0.7em 1.5em;
      border-radius: 8px;
      text-decoration: none;
      transition: 0.3s;
    }
    .cta-button:hover {
      background-color: #00ddcc;
    }
    .section {
      max-width: 900px;
      margin: 3em auto;
      padding: 1em 2em;
    }
    h2 {
      color: #00ffee;
      margin-bottom: 0.5em;
    }
    .whale-meter-container, .sentiment-bar {
      background-color: #00485f;
      border-radius: 6px;
      overflow: hidden;
      height: 24px;
      margin-bottom: 0.75em;
    }
    .whale-meter-fill {
      height: 100%;
      width: 0;
      background-color: #00ffee;
      transition: width 1.5s ease-in-out;
    }
    .sentiment-fill-bullish {
      background-color: #00ff88;
      height: 100%;
      float: left;
      width: 0;
      transition: width 1.5s ease-in-out;
    }
    .sentiment-fill-bearish {
      background-color: #ff0044;
      height: 100%;
      float: left;
      width: 0;
      transition: width 1.5s ease-in-out;
    }
    .legend {
      font-size: 0.9em;
      margin-top: -0.5em;
      margin-bottom: 1.5em;
      color: #ccc;
    }
    .legend span {
      margin-right: 1em;
    }
    .timestamp {
      font-size: 0.85em;
      color: #aaa;
      margin-top: -0.3em;
      margin-bottom: 1em;
    }
    .trade-box {
      background-color: #003850;
      border-radius: 8px;
      padding: 1em;
      margin-bottom: 1em;
    }
    #whaleBot {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: #002b3f;
      color: #00ffee;
      border-radius: 12px;
      padding: 1em;
      width: 260px;
      font-size: 0.9em;
      box-shadow: 0 0 10px #00ffee;
    }
    @media (max-width: 600px) {
      .hero h1 {
        font-size: 2em;
      }
      .hero p {
        font-size: 1em;
      }
    }
  </style>
</head>
<body>
  <nav>
    <a href="index.html">Home</a>
    <a href="learn.html">Learn</a>
    <a href="simulate.html">Simulate</a>
    <a href="harvesting.html">Premium Harvesting</a>
    <a href="whisper.html">Whispers</a>
  </nav>

  <div class="hero">
    <img src="/whale.png" alt="WhaleWatch Logo" class="homepage-logo" />
    <h1>WhaleWatch.Trade</h1>
    <p>We track the whales so you can harvest the premium.</p>
    <a href="harvesting.html" class="cta-button">What Is Premium Harvesting?</a>
  </div>

  <div class="section">
    <h2>🌊 Whale Meter</h2>
    <div class="whale-meter-container">
      <div id="whaleFill" class="whale-meter-fill"></div>
    </div>
    <div id="whaleTimestamp" class="timestamp">Loading...</div>
    <div class="legend">
      <span>🟢 Green = Bullish (Calls)</span>
      <span>🔴 Red = Bearish (Puts)</span>
      <span>🎨 Gradient = Mixed Premium Flow</span>
    </div>
    <p style="font-size: 0.95em;">
      The Whale Meter shows where the most capital is currently concentrated in the options market, based on open interest and last traded price. These aren’t necessarily trades placed today, but represent the largest bets whales are riding for the nearest expiration. Use it to spot where the wave is building.
    </p>
  </div>

  <div class="section">
    <h2>📈 Bullish vs. Bearish Sentiment</h2>
    <div class="sentiment-bar">
      <div id="bullFill" class="sentiment-fill-bullish"></div>
      <div id="bearFill" class="sentiment-fill-bearish"></div>
    </div>
    <div id="sentimentLabel" class="legend">Loading...</div>
  </div>

  <div class="section">
    <h2>📊 Latest Whale Trades</h2>
    <div id="whaleList">Loading...</div>
    <p style="font-size: 0.95em; color: #aaa;">
      These are the top 10 highest-premium options trades — filtered by size, strike, and expiration. Think of them as the largest foam trails left behind by whales. Watch for patterns and use them to guide your own simulated or real trades.
    </p>
  </div>

  <div id="whaleBot">
    🤖 <strong>WhaleBot</strong><br />
    Ask me anything about:<br />
    • Covered calls<br />
    • Put selling<br />
    • Whale trades<br />
    • Premium harvesting<br />
    <br />
    (Coming soon: live chat!)
  </div>

  <script>
    function updateWhaleData() {
      fetch("whales.json")
        .then(res => res.json())
        .then(data => {
          const trades = data.whale_trades || [];
          const ts = new Date(data.timestamp);
          document.getElementById("whaleTimestamp").textContent =
            `Last updated: ${ts.toLocaleString()}`;

          const totalPremium = trades.reduce((sum, t) => sum + t.premium, 0);
          const fill = document.getElementById("whaleFill");
          const percent = Math.min((totalPremium / 1000000) * 100, 100);
          fill.style.width = percent + "%";
          fill.style.background =
            trades.some(t => t.type === "CALL") && trades.some(t => t.type === "PUT")
              ? "linear-gradient(to right, #00ff88, #ffaa00, #ff0044)"
              : trades.every(t => t.type === "CALL")
                ? "#00ff88"
                : "#ff0044";

          const bullCount = trades.filter(t => t.type === "CALL").length;
          const bearCount = trades.filter(t => t.type === "PUT").length;
          const totalCount = bullCount + bearCount;
          const bullPct = totalCount ? (bullCount / totalCount) * 100 : 50;
          const bearPct = 100 - bullPct;

          document.getElementById("bullFill").style.width = bullPct + "%";
          document.getElementById("bearFill").style.width = bearPct + "%";
          document.getElementById("sentimentLabel").textContent =
            `🐂 Bullish: ${bullPct.toFixed(1)}% | 🐻 Bearish: ${bearPct.toFixed(1)}%`;

          document.getElementById("whaleList").innerHTML = trades.map(t => `
            <div class="trade-box">
              <strong>${t.symbol}</strong> — ${t.type}<br/>
              Strike: $${t.strike}, Exp: ${t.expiration}, Premium: $${t.premium.toLocaleString()}
            </div>
          `).join("");
        })
        .catch(err => {
          document.getElementById("whaleTimestamp").textContent = "Failed to load whale data.";
        });
    }

    updateWhaleData();
    setInterval(updateWhaleData, 60000);
  </script>
</body>
</html>
