function updateDropdowns() {
  const symbol = document.getElementById("symbol").value;
  let type = document.getElementById("type").value.toUpperCase();
  const typeNote = document.getElementById("type-note");

  let filtered = whaleData.filter(t => t.symbol === symbol && t.type === type);

  // If no data for the selected type, fallback to the other type
  if (filtered.length === 0) {
    const fallback = type === "CALL" ? "PUT" : "CALL";
    const fallbackData = whaleData.filter(t => t.symbol === symbol && t.type === fallback);

    if (fallbackData.length > 0) {
      type = fallback;
      document.getElementById("type").value = fallback;
      filtered = fallbackData;

      typeNote.innerHTML = `⚠️ Only <strong>${fallback}</strong> trades are available for <strong>${symbol}</strong>. We switched it for you.`;
      typeNote.style.display = "block";
    } else {
      // No data at all for this symbol
      typeNote.innerHTML = `⚠️ No available whale trades found for <strong>${symbol}</strong>.`;
      typeNote.style.display = "block";
      populateDropdown("strike", []);
      populateDropdown("expiration", []);
      populateDropdown("premium", []);
      return;
    }
  } else {
    typeNote.style.display = "none";
  }

  // Populate dropdowns
  populateDropdown("strike", [...new Set(filtered.map(t => t.strike))]);
  populateDropdown("expiration", [...new Set(filtered.map(t => t.expiration))]);
  populateDropdown("premium", [...new Set(filtered.map(t => (t.premium / 100).toFixed(2)))]);
}
